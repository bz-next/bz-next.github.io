<!DOCTYPE html>
<html lang="en">
<!-- Beautiful Jekyll 6.0.1 | Copyright Dean Attali 2023 -->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  

  

  

  <title>Building | BZ-Next: Modernizing BZFlag</title>

  
  
  <meta name="author" content="BZ-Next">
  

  <meta name="description" content="# Building the source code on Linux The following instructions are for Fedora 39. If using another distro, package names and package install procedure may be different, but the overall process should be the same. ### Install development tools ``` $ sudo dnf groupinstall &quot;Development Tools&quot; $ sudo dnf install...">

  

  

  
  <link rel="alternate" type="application/rss+xml" title="BZ-Next: Modernizing BZFlag" href="/feed.xml">
  

  

  

  

  


  
    
      
  <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">


    
      
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css">


    
      
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic">


    
      
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800">


    
  

  
    
      <link rel="stylesheet" href="/assets/css/bootstrap-social.css">
    
      <link rel="stylesheet" href="/assets/css/beautifuljekyll.css">
    
  

  

  
  
  

  

  
  <meta property="og:site_name" content="BZ-Next: Modernizing BZFlag">
  <meta property="og:title" content="Building | BZ-Next: Modernizing BZFlag">
  <meta property="og:description" content="# Building the source code on Linux The following instructions are for Fedora 39. If using another distro, package names and package install procedure may be different, but the overall process should be the same. ### Install development tools ``` $ sudo dnf groupinstall &quot;Development Tools&quot; $ sudo dnf install...">

  
  <meta property="og:image" content="/assets/img/avatar-icon.png">
  

  
  <meta property="og:type" content="website">
  <meta property="og:url" content="/building/">
  <link rel="canonical" href="/building/">
  

  
  <meta name="twitter:card" content="summary">
  
  <meta name="twitter:site" content="@">
  <meta name="twitter:creator" content="@">

  <meta property="twitter:title" content="Building | BZ-Next: Modernizing BZFlag">
  <meta property="twitter:description" content="# Building the source code on Linux The following instructions are for Fedora 39. If using another distro, package names and package install procedure may be different, but the overall process should be the same. ### Install development tools ``` $ sudo dnf groupinstall &quot;Development Tools&quot; $ sudo dnf install...">

  
  <meta name="twitter:image" content="/assets/img/avatar-icon.png">
  

  


  

  
  

  

</head>


<body>
  


  <nav class="navbar navbar-expand-xl navbar-light fixed-top navbar-custom top-nav-regular"><a class="navbar-brand" href="/">BZ-Next: Modernizing BZFlag</a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#main-navbar" aria-controls="main-navbar" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>

  <div class="collapse navbar-collapse" id="main-navbar">
    <ul class="navbar-nav ml-auto">
          <li class="nav-item">
            <a class="nav-link" href="/about">About The Project</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="/releases">Releases</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="/building">Building</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="https://github.com/bz-next/bz-next">GitHub</a>
          </li>
          <li class="nav-item dropdown">
            <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Resources</a>
            <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdown">
                  <a class="dropdown-item" href="https://github.com/bz-next/bz-next">GitHub</a>
                  <a class="dropdown-item" href="https://www.bzflag.org">BZFlag Homepage</a>
                  <a class="dropdown-item" href="https://wiki.bzflag.org/Main_Page">BZFlag Wiki</a>
                  <a class="dropdown-item" href="https://forums.bzflag.org">BZFlag Forums</a>
            </div>
          </li>
        
        <li class="nav-item">
          <a class="nav-link" id="nav-search-link" href="#" title="Search">
            <span id="nav-search-icon" class="fa fa-search"></span>
            <span id="nav-search-text">Search</span>
          </a>
        </li></ul>
  </div>

  

  
    <div class="avatar-container">
      <div class="avatar-img-border">
        <a href="/">
          <img alt="Navigation bar avatar" class="avatar-img" src="/assets/img/avatar-icon.png" />
        </a>
      </div>
    </div>
  

</nav>



<div id="beautifuljekyll-search-overlay">

  <div id="nav-search-exit" title="Exit search">✕</div>
  <input type="text" id="nav-search-input" placeholder="Search">
  <ul id="search-results-container"></ul>
  
  <script src="https://unpkg.com/simple-jekyll-search@latest/dest/simple-jekyll-search.min.js"></script>
  <script>
    var searchjson = '[ \
       \
        { \
          "title"    : "GLES2 support added to development branch", \
          "desc"     : "GLES2 support added to development branch", \
          "category" : "Site Updates", \
          "url"      : "/2024-02-05-GLES2/", \
          "date"     : "February  5, 2024" \
        }, \
       \
        { \
          "title"    : "MinGW support added to development branch", \
          "desc"     : "MinGW support added to development branch", \
          "category" : "Site Updates", \
          "url"      : "/2024-02-03-mingw-in-dev/", \
          "date"     : "February  3, 2024" \
        }, \
       \
        { \
          "title"    : "Mesh generation cleaned up", \
          "desc"     : "Mesh generation cleaned up", \
          "category" : "Site Updates", \
          "url"      : "/2024-02-03-meshgen-memory/", \
          "date"     : "February  3, 2024" \
        }, \
       \
        { \
          "title"    : "BZ-Next Site Created", \
          "desc"     : "BZ-Next Site Created", \
          "category" : "Site Updates", \
          "url"      : "/2024-02-01-first/", \
          "date"     : "February  1, 2024" \
        }, \
       \
       \
        { \
          "title"    : "About BZ-Next", \
          "desc"     : "About BZ-Next", \
          "category" : "page", \
          "url"      : "/about/", \
          "date"     : "January 1, 1970" \
        }, \
       \
        { \
          "title"    : "Building", \
          "desc"     : "Building", \
          "category" : "page", \
          "url"      : "/building/", \
          "date"     : "January 1, 1970" \
        }, \
       \
        { \
          "title"    : "BZ-Next", \
          "desc"     : "BZ-Next", \
          "category" : "page", \
          "url"      : "/", \
          "date"     : "January 1, 1970" \
        }, \
       \
        { \
          "title"    : "Releases", \
          "desc"     : "Releases", \
          "category" : "page", \
          "url"      : "/releases/", \
          "date"     : "January 1, 1970" \
        }, \
       \
        { \
          "title"    : "Tag Index", \
          "desc"     : "Tag Index", \
          "category" : "page", \
          "url"      : "/tags/", \
          "date"     : "January 1, 1970" \
        } \
       \
    ]';
    searchjson = JSON.parse(searchjson);

    var sjs = SimpleJekyllSearch({
      searchInput: document.getElementById('nav-search-input'),
      resultsContainer: document.getElementById('search-results-container'),
      json: searchjson
    });
  </script>
</div>





  



<header class="header-section ">
<div class="intro-header ">
  
  <div class="container-md">
    <div class="row">
      <div class="col-xl-8 offset-xl-2 col-lg-10 offset-lg-1">
        <div class="page-heading">
          <h1>Building</h1>
          
          
          
        </div>
      </div>
    </div>
  </div>
  
  
</div>



</header>


<main class=" container-md ">
  <div class="row">
    <div class=" col-xl-8 offset-xl-2 col-lg-10 offset-lg-1 ">
      

      <h1 id="building-the-source-code-on-linux">Building the source code on Linux</h1>

<p>The following instructions are for Fedora 39. If using another distro, package names and package install procedure may be different, but the overall process should be the same.</p>

<h3 id="install-development-tools">Install development tools</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ sudo dnf groupinstall "Development Tools"
$ sudo dnf install cmake g++ mesa-libGL-devel mesa-libGLU-devel SDL2-devel libpng-devel curl-devel c-ares-devel glew-devel ncurses-devel
</code></pre></div></div>

<h3 id="clone-repository-and-populate-submodules">Clone repository and populate submodules</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ git clone https://github.com/bz-next/bz-next.git
$ cd bz-next
$ git submodule update --init --recursive
</code></pre></div></div>

<h3 id="make-a-directory-to-contain-build-stuff">Make a directory to contain build stuff</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ mkdir build
$ cd build
</code></pre></div></div>

<h3 id="run-cmake-to-configure-the-build">Run cmake to configure the build</h3>

<p>Specify any build options here. You can build a release build (more optimized) by specifying <code class="language-plaintext highlighter-rouge">-DCMAKE_BUILD_TYPE=Release</code> instead of <code class="language-plaintext highlighter-rouge">Debug</code>. <code class="language-plaintext highlighter-rouge">-DCMAKE_EXPORT_COMPILE_COMMANDS=On</code> generates a <code class="language-plaintext highlighter-rouge">compile-commands.json</code> that can be fed to <code class="language-plaintext highlighter-rouge">clangd</code> for editor instrumentation.</p>

<p>The following will build a debug build, and disable the server, bzadmin, and clients:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ cmake -DCMAKE_EXPORT_COMPILE_COMMANDS=On -DCMAKE_BUILD_TYPE=Debug -DENABLE_CLIENT=TRUE -DENABLE_SERVER=FALSE -DENABLE_PLUGINS=FALSE ..
</code></pre></div></div>

<p>If you’re building for an embedded device with GLES, add the following defines to your cmake step:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>-DMAGNUM_TARGET_GLES=ON -DMAGNUM_TARGET_GLES2=ON
</code></pre></div></div>

<p>GLES builds currently disable multisampling (defaults to 4x on non-GLES builds), sets texture filters to nearest instead of linear, and sets anisotropy to minimums.</p>

<h3 id="run-make">Run make</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ make -j$(nproc)
</code></pre></div></div>

<h3 id="running-the-client">Running the client</h3>

<p>The client looks for textures in <code class="language-plaintext highlighter-rouge">/data</code> from the directory from which it is run. It’s best to execute the client from the main repo directory so that it can find everything it needs.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ cd ..
$ build/Debug/bin/bzflag-next
</code></pre></div></div>

<p>If you built a Release client, the path would be <code class="language-plaintext highlighter-rouge">build/Release/bin/bzflag-next</code></p>

<h1 id="cross-compiling-for-windows-from-linux-using-mingw64">Cross-compiling for Windows from Linux using MinGW64</h1>

<p>It is possible to build a windows release completely from Linux, using MinGW64. The rough steps are:</p>

<ul>
  <li>Install MinGW64</li>
  <li>Install dependencies for the Windows build (GLEW, libpng, libtre, zlib, SDL2, OpenSSL, curl, c-ares, …)</li>
  <li>Build using CMake</li>
  <li>Package resulting .exe along with necessary <code class="language-plaintext highlighter-rouge">.dll</code> files and program data.</li>
</ul>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code># Install MinGW64 if you haven't already
# sudo dnf install mingw64-gcc mingw64-gcc-c++ mingw64-libstdc++

# Set this to your MinGW64 system root
export MINGW_PREFIX=/usr/x86_64-w64-mingw32/sys-root/mingw

$ mkdir mingw-libs-src
$ cd mingw-libs-src

$ wget https://c-ares.org/download/c-ares-1.26.0.tar.gz
$ tar -xf ./c-ares-1.26.0.tar.gz
$ cd c-ares-1.26.0/
$ mkdir build
$ cd build
$ mingw64-cmake -DCMAKE_PREFIX_PATH=$MINGW_PREFIX ..
$ mingw64-make -j$(nproc)
$ sudo mingw64-make install

$ cd ../..

$ wget https://github.com/rockdaboot/libpsl/releases/download/0.21.5/libpsl-0.21.5.tar.gz
$ tar -xf ./libpsl-0.21.5.tar.gz
$ cd libpsl-0.21.5/
$ mingw64-configure --prefix=$MINGW_PREFIX
$ mingw64-make -j$(nproc)
$ sudo mingw64-make install

$ cd ..

$ wget https://github.com/libsdl-org/SDL/releases/download/release-2.28.5/SDL2-2.28.5.tar.gz
$ tar -xf ./SDL2-2.28.5.tar.gz
$ cd SDL2-2.28.5/
$ mingw64-configure --prefix=$MINGW_PREFIX
$ mingw64-make -j$(nproc)
$ sudo mingw64-make install -j$(nproc)

$ cd ..

$ wget https://sourceforge.net/projects/glew/files/glew/2.1.0/glew-2.1.0.tgz/download -O glew-2.1.0.tgz
$ tar -xf ./glew-2.1.0.tgz
$ cd glew-2.1.0/build/cmake
$ mkdir build
$ cd build
$ mingw64-cmake -DCMAKE_PREFIX_PATH=$MINGW_PREFIX ..
$ mingw64-make -j$(nproc)
$ sudo mingw64-make install

$ cd ../../../..

# Need zlib for libpng
$ wget https://www.zlib.net/zlib-1.3.1.tar.gz
$ tar -xf ./zlib-1.3.1.tar.gz
$ cd zlib-1.3.1/
$ mkdir build
$ cd build
$ mingw64-cmake -DCMAKE_PREFIX_PATH=$MINGW_PREFIX ..
$ mingw64-make -j$(nproc)
$ sudo mingw64-make install

$ cd ../..

$ wget http://prdownloads.sourceforge.net/libpng/libpng-1.6.41.tar.gz?download -O libpng-1.6.41.tar.gz
$ tar -xf ./libpng-1.6.41.tar.gz
$ cd libpng-1.6.41/
$ mkdir build
$ cd build
$ mingw64-cmake -DCMAKE_PREFIX_PATH=$MINGW_PREFIX ..
$ mingw64-make -j$(nproc)
$ sudo mingw64-make install

$ cd ../..

# Need perl for the OpenSSL install, get it if you don't have it yet
$ sudo dnf install perl

# Need OpenSSL for curl
$ wget https://www.openssl.org/source/openssl-3.0.13.tar.gz
$ tar -xf ./openssl-3.0.13.tar.gz
$ cd openssl-3.0.13/
$ ./Configure mingw64 --cross-compile-prefix=x86_64-w64-mingw32- --prefix=$MINGW_PREFIX --openssldir=$MINGW_PREFIX
$ mingw64-make -j$(nproc)
$ sudo mingw64-make install -j$(nproc)

$ cd ..

$ wget https://curl.se/download/curl-8.6.0.tar.gz
$ tar -xf ./curl-8.6.0.tar.gz
$ cd curl-8.6.0/
$ mkdir build
$ cd build
$ mingw64-cmake -DCMAKE_PREFIX_PATH=$MINGW_PREFIX -DCURL_USE_OPENSSL=ON ..
$ mingw64-make -j$(nproc)
$ sudo mingw64-make install -j$(nproc)

$ cd ../..

# Need autopoint installed to install tre
# sudo dnf install gettext-devel

# Need libtool to install tre
# sudo dnf install libtool

# Need tre for systre
$ git clone https://github.com/laurikari/tre.git
$ cd tre
$ ./utils/autogen.sh
$ mingw64-configure --prefix=$MINGW_PREFIX --enable-static
$ mingw64-make -j$(nproc)
$ sudo mingw64-make install -j$(nproc)

$ cd ..

$ wget https://github.com/msys2/MINGW-packages/raw/master/mingw-w64-libsystre/systre-1.0.1.tar.xz
$ tar -xf ./systre-1.0.1.tar.xz
$ cd systre-1.0.1/
$ mingw64-configure --prefix=$MINGW_PREFIX
$ sudo mingw64-make -j$(nproc)
$ sudo mingw64-make install -j$(nproc)

$ cd ..

# Finally, we need corrade-rc from corrade for resource-packaging in bz-next
# It has to be a locally-runnable executable, it's used during the build process
# I assume you want to install it to $HOME/.local/bin
# Whereever it gets installed, it should be on your $PATH
$ git clone https://github.com/mosra/corrade.git
$ cd corrade
$ mkdir build
$ cd build
$ cmake -DCMAKE_INSTALL_PREFIX=$HOME/.local ..
$ make -j$(nproc)
$ make install

# We need to fixup tre's install, since gcc can't find it by default
$ cd $MINGW_PREFIX/lib
$ sudo cp ./libtre.dll.a ./libtre.a
</code></pre></div></div>

<p>Now we are finally tooled up to build the client.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ git clone https://github.com/bz-next/bz-next.git
$ cd bz-next

$ git submodule update --init --recursive

mkdir build
cd build

# Just build the client. Builds for other targets might be broken
$ mingw64-cmake -DENABLE_BZADMIN=FALSE -DENABLE_SERVER=FALSE -DENABLE_ROBOTS=FALSE -DENABLE_PLUGINS=FALSE -DCMAKE_BUILD_TYPE=Release ..

# Build
$ mingw64-make -j$(nproc)
</code></pre></div></div>

<p>To make a distribution, copy the files from <code class="language-plaintext highlighter-rouge">Release/bin/</code> to a new directory. Copy the <code class="language-plaintext highlighter-rouge">data</code> directory from the main source dir as well.
Finally, we need to package the <code class="language-plaintext highlighter-rouge">.dll</code> files that Windows users will need to run the program. A quick fix is to just copy all the <code class="language-plaintext highlighter-rouge">.dll</code> files
from <code class="language-plaintext highlighter-rouge">$MINGW_PREFIX/bin</code> to your distribution:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ cp $MINGW_PREFIX/bin/*.dll .
</code></pre></div></div>


      

      

    </div>
  </div>
</main>


  <footer>
  <div class="container-md beautiful-jekyll-footer">
    <div class="row">
      <div class="col-xl-8 offset-xl-2 col-lg-10 offset-lg-1">
      
<ul class="list-inline text-center footer-links"><li class="list-inline-item">
    <a href="/feed.xml" title="RSS">
      <span class="fa-stack fa-lg" aria-hidden="true">
        <i class="fas fa-circle fa-stack-2x"></i>
        <i class="fas fa-rss fa-stack-1x fa-inverse"></i>
      </span>
      <span class="sr-only">RSS</span>
    </a>
  </li><li class="list-inline-item">
    <a href="https://github.com/bz-next" title="GitHub">
      <span class="fa-stack fa-lg" aria-hidden="true">
        <i class="fas fa-circle fa-stack-2x"></i>
        <i class="fab fa-github fa-stack-1x fa-inverse"></i>
      </span>
      <span class="sr-only">GitHub</span>
   </a>
  </li></ul>

      
      <p class="copyright text-muted">
      
        BZ-Next
        &nbsp;&bull;&nbsp;
      
      2024

      
        &nbsp;&bull;&nbsp;
        <span class="author-site">
          <a href="/">bz-next.github.io</a>
        </span>
      

      

      

      </p>
      <p class="theme-by text-muted">
        Powered by
        <a href="https://beautifuljekyll.com">Beautiful Jekyll</a>
      </p>
      </div>
    </div>
  </div>
</footer>


  
  
    
  <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js" integrity="sha256-4+XzXVhsDmqanXGHaHvgh1gMQKX40OUvDEBTu8JcmNs=" crossorigin="anonymous"></script>


  
    
  <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>


  
    
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js" integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" crossorigin="anonymous"></script>


  



  
    <!-- doing something a bit funky here because I want to be careful not to include JQuery twice! -->
    
      <script src="/assets/js/beautifuljekyll.js"></script>
    
  









</body>
</html>
